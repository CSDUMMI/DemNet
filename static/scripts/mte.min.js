/*!
 * ----------------------------------------------------------
 *  MARKDOWN TEXT EDITOR PLUGIN 1.5.2
 * ----------------------------------------------------------
 * Author: Taufik Nurrohman <http://latitudu.com>
 * License: MIT
 *
 * REQUIRES:
 * ==========================================================
 * [1]. https://github.com/tovic/simple-text-editor-library
 * [2]. https://github.com/FortAwesome/Font-Awesome
 * ==========================================================
 * ----------------------------------------------------------
 *
 */
var MTE=function(e,t){function n(e){return void 0!==e}function r(e){return"string"==typeof e}function i(e){return"number"==typeof e}function l(e){return"function"==typeof e}function a(e){return"object"==typeof e}function o(e,t,n){return t="on"+t,null===n?e[t]=null:(l(e[t])&&(n=function(e,t){return function(){return e.apply(this,arguments),t.apply(this,arguments)}}(e[t],n)),void(e[t]=n))}function c(e,t){e=e||{};for(var n in t)e[n]=a(t[n])?c(e[n],t[n]):t[n];return e}function u(e,t){var n=t.replace(/\-(\w)/g,function(e,t){return t.toUpperCase()}),r=0;return r=Z.defaultView&&Z.defaultView.getComputedStyle?Z.defaultView.getComputedStyle(e,null).getPropertyValue(t):e.style[n]}function s(e,t){return $t(e,function(){wt(t.end+1,!0)}),!1}function f(e){return e.replace(/^\s+|\s+$/g,"")}function p(e){return e.replace(/^\s+/,"")}function d(e){return e.replace(/\s+$/,"")}function g(e){return e.replace(et.escape,"\\$1")}function h(e){return e.parentNode}function v(e){return{w:e.offsetWidth,h:e.offsetHeight}}function m(e){return{l:e.offsetLeft,t:e.offsetTop}}function x(e){return Z.createElement(e)}var b="\u2018",k="\u2019",$="\u201C",C="\u201D",y="\u2013",E="\u2014",w="\u2026",L="\u00A6",T="\u00A9",O="\u2117",_="\u2120",R="\u2122",H="\u00AE",M="\u00B1",N="\u00D7",S="\u00F7",A="\u00B0",B="\u2039",I="\u203A",z="\u00AB",U="\u00BB",D="\u2264",K="\u2265",P="\u2260",Y="\u2190",q="\u2192",X="\u2191",Q="\u2193",F="\u21B5",V="\u2318",W="\u00B7",G="\u2116",j=this,J=window,Z=document,et=new Editor(e),tt=function(){},nt={tabSize:"    ",toolbar:!0,shortcut:!1,dir:"ltr",areaClass:"editor-area",toolbarClass:"editor-toolbar",toolbarIconClass:"fa fa-%s",toolbarButtonClass:"editor-toolbar-button editor-toolbar-button-%s",toolbarSeparatorClass:"editor-toolbar-separator",toolbarPosition:"before",dropClass:"custom-drop custom-drop-%s",modalClass:"custom-modal custom-modal-%s",modalHeaderClass:"custom-modal-header custom-modal-%s-header",modalContentClass:"custom-modal-content custom-modal-%s-content",modalFooterClass:"custom-modal-footer custom-modal-%s-footer",modalOverlayClass:"custom-modal-overlay custom-modal-%s-overlay",autoComplete:!0,autoIndent:!0,emptyElementSuffix:">",enableSETextHeader:!0,closeATXHeader:!1,STRONG:"**",EM:"_",UL:"- ",OL:"%d. ",HR:"---",CODE:"`",PRE:"    ",BLOCKQUOTE:"> ",actions:{ok:"OK",cancel:"Cancel",yes:"Yes",no:"No",open:"Open",close:"Close"},buttons:{bold:["Bold",V+"+B"],italic:["Italic",V+"+I"],code:["Code",V+"+K"],quote:["Quote",V+"+Q"],heading:["H1 "+y+" H6",V+"+H"],link:["Link",V+"+L"],image:["Image",V+"+G"],ol:["Ordered List",V+"++"],ul:["Unordered List",V+"+-"],rule:["Horizontal Rule",V+"+R"],undo:["Undo",V+"+Z"],redo:["Redo",V+"+Y"]},placeholders:{text:"text goes here"+w,heading_text:"Heading",link_text:"link text",list_ul_text:"List item",list_ol_text:"List item",image_alt:"Image"},prompts:{link_title:"link title goes here"+w,link_title_title:"Link Title",link_url:"http://",link_url_title:"Link URL",image_title:"image title goes here"+w,image_title_title:"Image Title",image_url:"http://",image_url_title:"Image URL"},update:tt,keydown:tt,click:tt,ready:tt,copy:tt,cut:tt,paste:tt},rt=Z.body,it=Z.documentElement,lt=x("div"),at=x("div"),ot=x("div"),ct=0,ut=null,st=null,ft=0,pt=0,dt=0,gt=0,ht=v(it).w,vt=Math.max(J.innerHeight,v(it).h),mt="\n\n",xt=" ",bt=e,kt=et.indent,$t=et.insert,Ct=et.key,yt=et.outdent,Et=et.replace,wt=et.select,Lt=et.selection,Tt=et.updateHistory,Ot=et.wrap,_t=J.setTimeout,Rt=c(nt,t),Ht=x("span");j.config=JSON.parse(JSON.stringify(Rt)),j.DOM={overlay:lt,modal:at,drop:ot};var Mt=g(Rt.UL).replace(/\\[-+*]/g,"[-+*]"),Nt=g(Rt.OL).replace(/%d/g,"\\d+"),St=g(Rt.tabSize),At=g(Rt.PRE),Bt=g(Rt.BLOCKQUOTE);j.shortcuts=[],j.shortcut=function(e,t){j.shortcuts[e.toLowerCase()]=t,j.shortcuts=function(){for(var e=Object.keys(j.shortcuts).sort().reverse(),t={},n=0,r=e.length;r>n;++n)t[e[n]]=j.shortcuts[e[n]];return t}()},j.event=function(e,t,n){return o(t,e,n)},j.modal=function(e,t,n){l(e)&&(n=t,t=e,e="default"),e=e||"default",n=n||{},ct=rt.scrollTop||it.scrollTop,lt.className=Rt.modalOverlayClass.replace(/%s/g,e),at.className=Rt.modalClass.replace(/%s/g,e),at.innerHTML='<div class="'+Rt.modalHeaderClass.replace(/%s/g,e)+'"></div><div class="'+Rt.modalContentClass.replace(/%s/g,e)+'"></div><div class="'+Rt.modalFooterClass.replace(/%s/g,e)+'"></div>';var r=at.style,i="left"in n,a="top"in n;r.visibility="hidden",_t(function(){rt.appendChild(lt),rt.appendChild(at)},.1),_t(function(){var e=v(at).w,t=v(at).h;r.position="absolute",r.left=i?n.left+"px":"50%",r.top=a?n.top+"px":"50%",r.zIndex="9999",r.marginLeft=(i?0:0-e/2)+"px",r.marginTop=(a?0:ct-t/2)+"px",r.visibility="",m(at).l<0&&!i&&(r.left=0,r.marginLeft=0,i=!0,n.left=0),m(at).t<0&&!a&&(r.top=0,r.marginTop=0,a=!0,n.top=0);var l=at.children[0];o(l,"mousedown",function(){return st=at,dt=ft-m(st).l,gt=pt-m(st).t,!1}),o(rt,"mousemove",null),o(rt,"mousemove",function(n){ft=n.pageX,pt=n.pageY+ct;var l,o,c=i?0:e/2,u=a?0:t/2;if(null!==st){var s=i?e:0,f=a?t:0;l=ft-dt+c,o=pt-gt+u,c>l&&(l=c),u>o&&(o=u),l+c+s>ht&&(l=ht-c-s),o+u+f>vt&&(o=vt-u-f),r.left=l+"px",r.top=o-ct+"px"}})},.2);var c=at.children;l(t)&&t(lt,at,c[0],c[1],c[2])},j.drop=function(e,t,n){l(e)&&(n=t,t=e,e="default"),!n&&ut&&(n={left:m(ut).l,top:m(ut).t+v(ut).h}),e=e||"default",n=n||{},ct=rt.scrollTop||it.scrollTop,ot.className=Rt.dropClass.replace(/%s/g,e);var r=ot.style,i="left"in n,a="top"in n;r.visibility="hidden",_t(function(){rt.appendChild(ot)},.1),_t(function(){var e=v(ot).w,t=v(ot).h;r.position="absolute",r.left=i?n.left+"px":"50%",r.top=a?n.top+"px":"50%",r.zIndex="9999",r.marginLeft=(i?0:0-e/2)+"px",r.marginTop=(a?0:ct-t/2)+"px",r.visibility="",n.left+e>ht&&(r.left=ht-e+"px",r.marginLeft=0),n.top+t>vt&&(r.top=vt-t+"px",r.marginTop=0)},.2),l(t)&&t(ot)},j.prompt=function(e,t,n,r,i){j.modal("prompt",function(i,a,c,u,s){var f=function(e){l(r)?(j.exit(),r(e)):j.exit(!0)},p=x("input");p.type="text",p.value=t,o(p,"keydown",function(e){var r=Ct(e);if("escape"==r)return j.exit(!0),!1;if("arrowdown"==r)return d.focus(),!1;if(n){if("enter"==r&&""!==this.value&&this.value!==t)return f(this.value),!1}else if("enter"==r)return f(this.value==t?"":this.value),!1});var d=x("button");d.innerHTML=Rt.actions.ok,o(d,"click",function(){return n?""!==p.value&&p.value!==t&&f(p.value):f(p.value==t?"":p.value),!1});var g=x("button");g.innerHTML=Rt.actions.cancel,o(g,"click",function(){return j.exit(!0),!1}),o(d,"keydown",function(e){var t=Ct(e);return"escape"==t?(j.exit(!0),!1):"arrowup"==t?(p.focus(),!1):"arrowright"==t?(g.focus(),!1):t.match(/^arrow(left|down)$/)?!1:void 0}),o(g,"keydown",function(e){var t=Ct(e);return"escape"==t?(j.exit(!0),!1):"arrowup"==t?(p.focus(),!1):"arrowleft"==t?(d.focus(),!1):t.match(/^arrow(right|down)$/)?!1:void 0}),c.innerHTML=e?e:"",u.appendChild(p),s.appendChild(d),s.appendChild(Z.createTextNode(" ")),s.appendChild(g),_t(function(){p.select()},.2)},i)},j.alert=function(e,t,n,r){j.modal("alert",function(r,i,a,c,u){var s=x("button");s.innerHTML=Rt.actions.ok,o(s,"click",function(){return l(n)?(j.exit(),n()):j.exit(!0),!1}),o(s,"keydown",function(e){return Ct(e,"escape")?(j.exit(!0),!1):void 0}),a.innerHTML=e?e:"",c.innerHTML=t?t:"",u.appendChild(s),_t(function(){s.focus()},.2)},r)},j.confirm=function(e,t,r,i){j.modal("confirm",function(i,a,c,u,s){var f=x("button");f.innerHTML=Rt.actions.ok,o(f,"click",function(){return n(r)&&l(r.OK)?(j.exit(),r.OK()):j.exit(!0),!1});var p=x("button");p.innerHTML=Rt.actions.cancel,o(p,"click",function(){return n(r)&&l(r.CANCEL)?(j.exit(),r.CANCEL()):j.exit(!0),!1}),o(f,"keydown",function(e){var t=Ct(e);return"escape"==t?(j.exit(!0),!1):"arrowright"==t?(p.focus(),!1):t.match(/^arrow(down|left)$/)?!1:void 0}),o(p,"keydown",function(e){var t=Ct(e);return"escape"==t?(j.exit(!0),!1):"arrowleft"==t?(f.focus(),!1):t.match(/^arrow(down|right)$/)?!1:void 0}),c.innerHTML=e?e:"",u.innerHTML=t?t:"",s.appendChild(f),s.appendChild(Z.createTextNode(" ")),s.appendChild(p),_t(function(){p.focus()},.2)},i)},j.exit=j.close=function(e){if(ut=null,st=null,h(lt)&&rt.removeChild(lt),h(at)&&rt.removeChild(at),h(ot)&&rt.removeChild(ot),e&&e!==!1){var t=Lt();a(e)||(e={}),wt("start"in e?e.start:t.start,"end"in e?e.end:t.end)}},o(J,"resize",function(){ht=v(it).w,vt=Math.max(J.innerHeight,v(it).h)}),o(rt,"mouseup",function(){st=null}),o(lt,"click",function(){j.exit(!0)}),j.scroll=function(e,t){i(e)?bt.scrollTop=e:bt.scrollTop+=parseInt(u(bt,"line-height"),10),l(t)&&t()},j.time=function(e){var t=new Date,r=t.getFullYear(),i=t.getMonth()+1,l=t.getDate(),a=t.getHours(),o=t.getMinutes(),c=t.getSeconds(),u=t.getMilliseconds();10>i&&(i="0"+i),10>l&&(l="0"+l),10>a&&(a="0"+a),10>o&&(o="0"+o),10>c&&(c="0"+c),10>u&&(u="0"+u);var s={Y:""+r,m:""+i,d:""+l,H:""+a,i:""+o,s:""+c,u:""+u};return n(e)?s[e]:s},Rt.toolbar&&(Ht.className=Rt.toolbarClass,o(Ht,"click",function(){return j.exit(!1),!1}),bt.parentNode.insertBefore(Ht,Rt.toolbarPosition.match(/^after|bottom$/i)?null:bt));var It=x("a");It.href="#esc:"+(new Date).getTime(),It.style.width=0,It.style.height=0,bt.parentNode.appendChild(It),j.button=function(e,t){if("|"===e)return j.separator(t);if(t=t||{},t.title!==!1){a(t.title)||(t.title=[t.title]);var n,c=x("a");if(c.className=Rt.toolbarButtonClass.replace(/%s/g,e),c.setAttribute("dir",t.dir||Rt.dir),c.setAttribute("tabindex",-1),c.href="#"+e.replace(" ",":").replace(/[^a-z0-9\:]/gi,"-").replace(/-+/g,"-").replace(/^-|-$/g,""),c.innerHTML=t.text?t.text.replace(/%s/g,e):'<i class="'+Rt.toolbarIconClass.replace(/%s/g,e)+'"></i>',t.title[0]&&(c.title=t.title[0]),t.title[1]&&(c.title+=" ("+t.title[1]+")"),a(t.attr))for(var u in t.attr)if(r(t.attr[u])&&"+="==t.attr[u].slice(0,2)){var s=c.getAttribute(u)||"";c.setAttribute(u,s+t.attr[u].slice(2))}else c.setAttribute(u,t.attr[u]);o(c,"click",function(e){if(l(t.click)){var n=this.hash.replace("#","");return ut=c,t.click(e,j),Rt.click(e,j,n),Rt.update(e,j,n),!1}}),o(c,"keydown",function(e){return Ct(e,"escape")?(j.exit(!0),!1):void 0}),i(t.position)?(n=t.position<0?t.position+Ht.children.length+1:t.position-1,Ht.insertBefore(c,Ht.children[n]||null)):Ht.appendChild(c),nt.buttons[e]=t}},j.separator=function(e){e=e||{};var t,n=x("span");if(n.className=Rt.toolbarSeparatorClass,a(e.attr))for(var l in e.attr)if(r(e.attr[l])&&"+="==e.attr[l].slice(0,2)){var o=n.getAttribute(l)||"";n.setAttribute(l,o+e.attr[l].slice(2))}else n.setAttribute(l,e.attr[l]);i(e.position)?(t=e.position<0?e.position+Ht.children.length+1:e.position-1,Ht.insertBefore(n,Ht.children[t]||null)):Ht.appendChild(n)},et.tidy=function(e,t,r,i){r=n(r)?r:e;var a,o=Lt(),c=-1===e.indexOf("\n")&&o.before.match(/\n$/),u=-1===r.indexOf("\n")&&o.after.match(/^\n/),s=c?o.before:d(o.before),g=f(o.value),h=u?o.after:p(o.after),v=s.length&&!c?e:"",m=h.length&&!u?r:"";return o.value.length&&!i&&l(t)?t(o):(bt.value=s+v+g+m+h,a=(s+v).length,wt(a,a+g.length),void(l(t)&&t(Lt())))},et.toggle=function(e,t,n,r){var i=Lt();if(i.before.slice(-e.length)!=e&&i.after.slice(0,t.length)!=t)Ot(e,t,!i.value.length&&r?function(){Et(/^/,r===!0?Rt.placeholders.text:r,n)}:!0);else{var l=i.before.slice(-e.length)==e?i.before.slice(0,-e.length):i.before,a=i.after.slice(0,t.length)==t?i.after.slice(t.length):i.after;bt.value=l+i.value+a,wt(l.length,(l+i.value).length,n||!0)}};var zt=0,Ut=Rt.buttons,Dt=et.tidy,Kt=et.toggle,Pt={bold:{title:Ut.bold,click:function(){var e=Rt.STRONG;Dt(xt,function(){Kt(e,e,!0,!0)})}},italic:{title:Ut.italic,click:function(){var e=Rt.EM;Dt(xt,function(){Kt(e,e,!0,!0)})}},"quote-right":{title:Ut.quote,click:function(){var e=Lt(),t=Rt.BLOCKQUOTE,n=d(e.before),r=f(e.value),i=(p(e.after),n.length?mt:"",Rt.placeholders.text);r==i?wt():(e.before.match(RegExp(Bt+"$"))||Dt(mt,1,mt,!0),et[r.match(RegExp("^"+Bt))?"outdent":"indent"](t,e.value.length?!0:function(){Et(/^/,Rt.placeholders.text)}))}},code:{title:Ut.code,click:function(){var e=Lt(),t="("+At+"|\\t| {4})",n=e.before.match(RegExp("(^|\\n)"+t+"?$")),r=Rt.CODE,i=Rt.PRE;if(n)if(-1===i.indexOf("%s"))Dt(mt,function(){et[e.value.match(RegExp("^"+t))?"outdent":"indent"](i,e.value.length?!0:function(){Et(/^/,Rt.placeholders.text)})},mt,!0);else{var l=i.split("%s");Dt(mt,function(){e=Lt(),Kt(l[0],l[1]||l[0],!0,!0)},mt,!e.before.match(RegExp(g(l[0])+"$")))}else Dt(xt,function(){Kt(r,r,!0,!0)})}},header:{title:Ut.heading,click:function(){var e,t=Lt(),n=["","#","##","###","####","#####","######"],r=["=","-"],i=d(t.before.replace(/#+ $/,"")),l=f(t.value.replace(/#+ | #+|\n+[-=]+/g,"").replace(/\n+/g," ")),a=p(t.after.replace(/^( #+|\n+[-=]+)/g,"")),o=i.length?mt:"",c=a.length?mt:"";if(zt=zt<n.length-1?zt+1:0,t.value.length){if(Rt.enableSETextHeader&&zt>0&&3>zt)bt.value=i+o+l+"\n"+l.replace(/./g,r[zt-1])+c+a,e=(i+o).length;else{var u=zt>0?" ":"";bt.value=i+o+n[zt]+u+l+(Rt.closeATXHeader?u+n[zt]:"")+c+a,e=(i+o+n[zt]+u).length}wt(e,e+l.length,!0)}else{var s=Rt.placeholders.heading_text;zt=1,Rt.enableSETextHeader?(bt.value=i+o+s+"\n"+s.replace(/./g,r[zt-1])+c+a,e=(i+o).length,wt(e,e+s.length,!0)):Dt(mt,function(){Ot(n[zt]+" ",Rt.closeATXHeader?" "+n[zt]:"",function(){Et(/^/,s)})},mt,!0)}}},link:{title:Ut.link,click:function(e){var t,n,r=Lt(),i=Rt.placeholders.link_text;Tt(),j.prompt(Rt.prompts.link_url_title,Rt.prompts.link_url,!0,function(l){n=l,j.prompt(Rt.prompts.link_title_title,Rt.prompts.link_title,!1,function(l){t=l.replace(/'/g,"&apos;").replace(/"/g,"&quot;"),Dt(xt,function(){Ot("[","]("+n+(""!==t?' "'+t+'"':"")+")",r.value.length?!0:function(){Et(/^/,i)})}),Rt.update(e,j)})})}},image:{title:Ut.image,click:function(e){var t,n;Tt(),j.prompt(Rt.prompts.image_url_title,Rt.prompts.image_url,!0,function(r){t=r,j.prompt(Rt.prompts.image_title_title,Rt.prompts.image_title,!1,function(r){n=r.replace(/"/g,"&quot;"),Dt(mt,function(){var e=Lt(),r=f(e.value.length?e.value:decodeURIComponent(t.split("/").pop().replace(/\..*$/,"").replace(/[-+._]/g," ")).toLowerCase().replace(/(?:^|\s)\S/g,function(e){return e.toUpperCase()}));r.length||(r=Rt.placeholders.image_alt),$t("!["+r+"]("+t+(""!==n?' "'+n+'"':"")+")",function(){e=Lt(),e.after.length||(bt.value+=mt),wt(e.end+2,!0)})},mt,!0),Rt.update(e,j)})})}},"list-ol":{title:Ut.ol,click:function(){var e=Lt(),t=Rt.placeholders.list_ol_text,n=0;if(e.value.length)e.value==t?wt():Dt(mt,function(){e.value.match(RegExp("^\\s*"+Nt))?yt(" *"+Nt,!0,!0):kt("",function(){Et(RegExp("(^|\\n) *"+Mt+" *","g"),"$1",tt),Et(/^[^\n]/gm,function(e){return n++,e.replace(/^/," "+Rt.OL.replace(/%d/g,n))})})},mt,!0);else if(e.before.match(/(^|\n)$/)){var r=" "+Rt.OL.replace(/%d/g,1);Dt(mt,function(){$t(r+t,function(){e=Lt(),wt(e.end-t.length,e.end,!0)})},mt,!0)}else{var i=RegExp("(^|\\n) *"+Nt+"(.*?)$"),l=e.before.replace(i,"$1$2");if(e.before.match(i))bt.value=l+e.after,wt(l.length,!0);else{var a=RegExp("(?:^|\\n) *("+Nt+").*?\n.*?$").exec(e.before),r=" "+Rt.OL.replace(/%d/g,a&&a[1]?parseInt(a[1],10)+1:1);e.before=e.before.replace(RegExp("(^|\\n) *"+Mt+"(.*?)$"),"$1$2").replace(/(^|\n)(.*?)$/,"$1"+r+"$2"),bt.value=e.before+e.after,wt(e.before.length,!0)}}}},"list-ul":{title:Ut.ul,click:function(){var e=Lt(),t=Rt.placeholders.list_ul_text,n=" "+Rt.UL;if(e.value.length)e.value==t?wt():Dt(mt,function(){Et(RegExp("(^|\\n) *"+Nt+" *","g"),"$1",tt),e.value.match(RegExp("^\\s*"+Mt))?et.outdent(" *"+Mt,!0,!0):et.indent(n)},mt,!0);else if(e.before.match(/(^|\n)$/))Dt(mt,function(){$t(n+t,function(){e=Lt(),wt(e.end-t.length,e.end,!0)})},mt,!0);else{var r=RegExp("(^|\\n) *"+Mt+"(.*?)$"),i=e.before.replace(r,"$1$2");e.before.match(r)?(bt.value=i+e.after,wt(i.length,!0)):(e.before=e.before.replace(RegExp("(^|\\n) *"+Nt+"(.*?)$"),"$1$2").replace(/(^|\n) *(.*?)$/,"$1"+n+"$2"),bt.value=e.before+e.after,wt(e.before.length,!0))}}},"ellipsis-h":{title:Ut.rule,click:function(){Dt(mt,function(){$t(Rt.HR,function(){var e=Lt();e.after.length||(bt.value+=mt),wt(e.end+2,!0)})},mt,!0)}},undo:{title:Ut.undo,click:et.undo},repeat:{title:Ut.redo,click:et.redo}};for(var Yt in Pt)j.button(Yt,Pt[Yt]);o(bt,"focus",j.exit),o(bt,"copy",function(e){var t=Lt();_t(function(){Rt.copy(t),Rt.update(e,j)},.1)}),o(bt,"cut",function(e){var t=Lt();_t(function(){t.end=t.start,Rt.cut(t),Rt.update(e,j),Tt()},.1)}),o(bt,"paste",function(e){var t=Lt();_t(function(){t.end=Lt().end,t.value=bt.value.substring(t.start,t.end),Rt.paste(t),Rt.update(e,j),Tt()},.1)}),o(bt,"keydown",function(e){var t=Lt(),n=t.before,r=t.value,i=t.after,l=t.start,a=t.end,o=Ct(e),c=e.ctrlKey,u=e.shiftKey,f=e.altKey,p="tab"==o;_t(function(){Rt.keydown(e,j),Rt.update(e,j)},.1);for(var h in j.shortcuts){var v=h.replace(/\+/g,"\n").replace(/\n\n/g,"\n+").split(/\n/),m=0;for(var x in v)(v[x].match(/^ctrl|control|command|cmd|meta$/)&&c||"shift"==v[x]&&u||v[x].match(/^alt(ernate)?|option$/)&&f||"tab"==v[x]&&p||v[x]==o)&&m++;if(m===v.length)return j.shortcuts[h](e,j)}var V=n,J=i[0],Z="\\"==V.slice(-1);if(Rt.autoComplete&&!Z){if(o==J&&(-1!==V.indexOf("(")&&")"==J||-1!==V.indexOf("{")&&"}"==J||-1!==V.indexOf("[")&&"]"==J||-1!==V.indexOf("<")&&">"==J||-1!==V.indexOf('"')&&'"'==J||-1!==V.indexOf("'")&&"'"==J||-1!==V.indexOf("`")&&"`"==J))return wt(a+1),!1;if("("==o)return s("("+r+")",t);if("{"==o)return s("{"+r+"}",t);if("["==o)return s("["+r+"]",t);if("<"==o)return s("<"+r+">",t);if('"'==o)return s('"'+r+'"',t);if(!n.match(/\w$/)){if("'"==o)return s("'"+r+"'",t);if("`"==o)return s("`"+r+"`",t)}}var nt="( *"+Nt+"| *"+Mt+"| *"+Bt+"|"+St+")";if(u&&p)return yt(Rt.toolbar?nt:St,!0,!0),!1;if(p){if(n.match(/<[^\/>]*?$/)&&">"==i[0]){var rt=/<([^\/>]*?)$/.exec(n),it=rt[1].split(" ")[0];return bt.value=it.match(/^br|hr|img|input|link|meta$/)?n+" "+Rt.emptyElementSuffix+i.substring(1):n+" ></"+it+i,wt(l+1,!0),!1}return kt(Rt.tabSize),!1}if(c&&"z"==o)return et.undo(),!1;if(c&&"y"==o)return et.redo(),!1;if(Rt.toolbar&&Rt.shortcut&&c){if("b"==o)return Pt.bold.click(),!1;if("g"==o)return Pt.image.click(),!1;if("h"==o)return Pt.header.click(),!1;if("i"==o)return Pt.italic.click(),!1;if(!u&&"k"==o)return Pt.code.click(),!1;if("l"==o)return Pt.link.click(),!1;if("q"==o)return Pt["quote-right"].click(),!1;if("r"==o)return Pt["ellipsis-h"].click(),!1;if("+"==o)return Pt["list-ol"].click(),!1;if("-"==o)return Pt["list-ul"].click(),!1}if(Rt.toolbar&&" "==o){var rt="(^|\\n)("+d(Nt)+"|"+d(Mt)+")";if(n.match(RegExp(rt+"$")))return bt.value=n.replace(RegExp(rt+"$"),"$1 $2 ")+r+i,wt(a+2,!0),!1}if("enter"==o){if(f&&!r.length)return $t(F),!1;if(Rt.toolbar){var lt="( *)("+Nt+"|"+Mt+"|(?:"+Bt+")+)( *)",rt=RegExp("(?:^|\\n)"+lt+"(.*?)$");if(n.match(rt)){var at=rt.exec(n),ot=RegExp(Nt).test(at[2])?Rt.OL.replace(/%d/g,parseInt(at[2],10)+1):at[2];return""===at[4]?yt(lt,!0,!0):$t("\n"+at[1]+ot+at[3],!0),j.scroll(),!1}}if(Rt.autoIndent){var ct=RegExp("(?:^|\\n)(("+St+")+)(.*?)$").exec(n),ut=ct?ct[1]:"";if(n.match(/[\(\{\[]$/)&&i.match(/^[\]\}\)]/)||n.match(/<[^\/]*?>$/)&&i.match(/^<\//))return $t("\n"+ut+St+"\n"+ut,function(){wt(l+(ut+Rt.tabSize).length+1,!0)}),j.scroll(),!1;if(n.match(RegExp(St+".*?$")))return $t("\n"+ut),j.scroll(),!1}}var st={"'":k,'"':C,"---":E,"--":y,"...":w,"|":L,"(c)":T,"(C)":T,"(p)":O,"(P)":O,"(sm)":_,"(SM)":_," sm":_," SM":_,"(tm)":R,"(TM)":R," tm":R," TM":R,"(r)":H,"(R)":H,"+-":M,"-+":M,x:N,"/":S,"^":A,"<<":z,">>":U,"<":B,">":I,"<=":D,">=":K,"!=":P,"No.":G,"NO.":G,"no.":G,".":W};if(r.length){if(f){Et(/'([^']*?)'/g,b+"$1"+k,tt),Et(/"([^"]*?)"/g,$+"$1"+C,tt);for(var h in st)Et(RegExp(g(h),"g"),st[h],tt);return Tt(),!1}}else{if(f){if(-1!==n.indexOf('"')&&'"'==i[0])return bt.value=n.replace(/"([^"]*?)$/,$+"$1")+C+i.slice(1),wt(a,!0),!1;if(-1!==n.indexOf("'")&&"'"==i[0])return bt.value=n.replace(/'([^']*?)$/,b+"$1")+k+i.slice(1),wt(a,!0),!1;if(n.slice(-2).match(/\w'$/i))return bt.value=n.slice(0,-1)+k+i,wt(a,!0),!1;if(n.slice(-2).match(/(^|\W)'$/i))return bt.value=n.slice(0,-1)+b+i,wt(a,!0),!1;if(n.match(/\((c|p|sm|tm|r)$/i)&&")"==i[0]){var ft=n.match(/\((sm|tm)$/i)?2:1;return bt.value=n.slice(0,-(ft+1))+st["("+n.slice(-ft).toLowerCase()+")"]+i.slice(1),wt(a-ft,!0),!1}var pt=n.replace(/&lt;/g,"<").replace(/&gt;/g,">"),dt=i.replace(/&lt;/g,"<").replace(/&gt;/g,">");if(-1!==pt.indexOf("<<")&&0===dt.indexOf(">>"))return bt.value=n.replace(/(?:<<|&lt;&lt;)([^<]*)$/,z+"$1")+i.replace(/^(?:>>|&gt;&gt;)/,U),wt(pt.length-1,!0),!1;if(-1!==pt.indexOf("<")&&0===dt.indexOf(">"))return bt.value=n.replace(/(?:<|&lt;)([^<]*)$/,B+"$1")+i.replace(/^(?:>|&gt;)/,I),wt(pt.length,!0),!1;for(var h in st)if(n.slice(-h.length)==h)return bt.value=n.slice(0,-h.length)+st[h]+i,wt(l-h.length+1,!0),!1;if("arrowleft"==o)return $t(Y),!1;if("arrowup"==o)return $t(X),!1;if("arrowright"==o)return $t(q),!1;if("arrowdown"==o)return $t(Q),!1}if("delete"==o&&i.match(/^<\/[^\n>]*?>/))return bt.value=n+i.replace(/^<\/[^\n>]*?>/,""),wt(l,!0),!1;if("backspace"==o){if(Rt.toolbar){var rt="( *"+Nt+"| *"+Mt+"|(?:> )+)";if(n.match(RegExp("^"+rt+"$","m")))return yt(rt,!0,!0),!1}if(n.match(RegExp("(^|\\n)("+St+")+$")))return yt(Rt.tabSize),!1;if(n.match(/<\/?[^\n>]*?>$/))return yt("<\\/?[^\\n>]*?>",!0,!0),!1;switch(n.slice(-1)){case"(":return Kt("(",")"),!1;case"{":return Kt("{","}"),!1;case"[":return Kt("[","]"),!1;case"<":return Kt("<",">"),!1;case'"':return Kt('"','"'),!1;case"'":return Kt("'","'"),!1;case" ":return Kt(" "," "),!1;case $:return Kt($,C),!1;case b:return Kt(b,k),!1;case z:return Kt(z,U),!1;case B:return Kt(B,I),!1}}}return"escape"==o?(It.focus(),!1):void(c||u||f||_t(Tt,.1))});var qt=RegExp("(^|\\s)"+Rt.areaClass+"(\\s|$)"),Xt=bt.className;Xt.match(qt)||(bt.className=f(Xt+" "+Rt.areaClass)),Rt.ready(j),j.grip=et,j.grip.config=Rt};