/*!
 * --------------------------------------------------------------------
 *  SIMPLE TEXT SELECTION LIBRARY FOR ONLINE TEXT EDITING (2016-02-15)
 * --------------------------------------------------------------------
 *  https://github.com/tovic/simple-text-editor-library
 * --------------------------------------------------------------------
 *
 *    Author : Taufik Nurrohman
 *    URL    : http://latitudu.com
 *
 * --------------------------------------------------------------------
 *
 */

var Editor=function(e){function t(e){return void 0!==e}function n(e){return"object"==typeof e}function r(e){return"function"==typeof e}var a=this,o=document,l=[];a.keys={8:"backspace",9:"tab",13:"enter",16:"shift",17:"control",18:"alt",19:"pause",20:"capslock",27:"escape",33:"pageup",34:"pagedown",37:"arrowleft",38:"arrowup",39:"arrowright",40:"arrowdown",44:"printscreen",45:"insert",46:"delete",91:"os",93:"contextmenu",112:"f1",113:"f2",114:"f3",115:"f4",116:"f5",117:"f6",118:"f7",119:"f8",120:"f9",121:"f10",122:"f11",123:"f12",48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],65:"a",66:"b",67:"c",68:"d",69:"e",70:"f",71:"g",72:"h",73:"i",74:"j",75:"k",76:"l",77:"m",78:"n",79:"o",80:"p",81:"q",82:"r",83:"s",84:"t",85:"u",86:"v",87:"w",88:"x",89:"y",90:"z",32:" ",59:[";",":"],61:["=","+"],173:["-","_"],188:[",","<"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']},a.index={undo:0,redo:0},a.area=t(e)?e:o.getElementsByTagName("textarea")[0],a.escape=/([!$^*\(\)\-=+\[\]\{\}\\|:<>,.\/?])/g,l[a.index.undo]={value:a.area.value,start:0,end:0},a.key=function(e,r){var o=e.keyCode||e.which,l=null;t(e.key)?l=e.key.toLowerCase():(l=a.keys[o]||null,n(l)&&(l=e.shiftKey?l[1]||l[0]:l[0]));var c={alternate:"alt",option:"alt",ctrl:"control",cmd:"control",command:"control",meta:"control",context:"contextmenu","return":"enter",ins:"insert",del:"delete",esc:"escape",home:"pageup",end:"pagedown",left:"arrowleft",up:"arrowup",right:"arrowright",down:"arrowdown",space:" "};return t(r)?l===(c[r.toLowerCase()]||r.toLowerCase()):l},a.selection=function(){var e=a.area.value.replace(/\r/g,""),t=a.area.selectionStart,n=a.area.selectionEnd,r={start:t,end:n,value:e.substring(t,n),before:e.substring(0,t),after:e.substring(n)};return r},a.select=function(e,n,l){var c=o.documentElement.scrollTop,u=o.body.scrollTop,s=a.area.scrollTop,d=a.selection();a.area.focus(),t(e)||(e=d.start,n=d.end),t(n)||(n=e),(r(n)||n===!0)&&(l=n,n=e),a.area.setSelectionRange(e,n),o.documentElement.scrollTop=c,o.body.scrollTop=u,a.area.scrollTop=s,l===!0?a.updateHistory():r(l)&&l()},a.replace=function(e,t,n){var r=a.selection(),o=r.start,l=(r.end,r.value.replace(e,t));a.area.value=r.before+l+r.after,a.select(o,o+l.length,n||!0)},a.insert=function(e,t){{var n=a.selection(),r=n.start;n.end}a.area.value=n.before+e+n.after,a.select(r+e.length,t||!0)},a.wrap=function(e,t,n,r){var o=a.selection(),l=o.value,c=o.before,u=o.after;r?a.replace(/^([\s\S]*?)$/,e+"$1"+t):(a.area.value=c+e+l+t+u,a.select((c+e).length,(c+e+l).length,n||!0))},a.indent=function(e,t){var n=a.selection();n.value.length>0?a.replace(/(^|\n)([^\n])/g,"$1"+e+"$2",t):(a.area.value=n.before+e+n.value+n.after,a.select(n.start+e.length,t||!0))},a.outdent=function(e,t,n){var r=a.selection(),o=n?e:e.replace(a.escape,"\\$1");if(r.value.length>0)a.replace(RegExp("(^|\n)"+o,"g"),"$1",t);else{var l=r.before.replace(RegExp(o+"$"),"");a.area.value=l+r.value+r.after,a.select(l.length,t||!0)}},a.callHistory=function(e){return e?l[e]:l},a.updateHistory=function(e,n){var r=a.selection(),o=t(e)?e:{value:a.area.value,start:r.start,end:r.end};a.index.undo++,l[n?n:a.index.undo]=o},a.undo=function(e){a.index.undo>0?a.index.undo--:a.index.undo=0,a.index.redo=a.index.undo;var t=l[a.index.undo];a.area.value=t.value,a.select(t.start,t.end,e)},a.redo=function(e){a.index.redo<l.length-1?a.index.redo++:a.index.redo=l.length-1,a.index.undo=a.index.redo;var t=l[a.index.redo];a.area.value=t.value,a.select(t.start,t.end,e)}};