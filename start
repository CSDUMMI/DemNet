#!/usr/bin/env bash

# Install pip3 Packages
pip3 install -U -r requirements.txt

# BUILD=Variable denoting current build string:
BUILD=`date -u +"%D-%T"`
BUILD="$BUILD-$BUILDER"

echo $BUILD >> BUILD.txt

# Test if the static analyses pases
if ! mypy main.py Server/*.py --ignore-missing-imports;
then exit 1

if [ $1 = "first-time" ]
then python3 -e "import Server.Database;create_tables()"
fi

# Start Server
gunicorn main:app
